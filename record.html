<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Workout Record</title>
</head>
<body>
  <h1>Workout Record</h1>

  <form id="recordForm">
    <label>Date: <input type="date" name="date" required></label><br />
    <label>Running Time (minutes): <input type="number" name="runningTime" required></label><br />
    <label>Walk Time (minutes): <input type="number" name="walkTime" required></label><br />
    <label>Coach Homework (times): <input type="number" name="coachHomework" required></label><br />
    <button type="submit">Submit</button>
  </form>

  <h2>History</h2>
  <div id="records"></div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbx9M6OuLyRjnf2E1yOxOeMdi2P3SBeyl9JRk6PzjYBR_17iakc6fkwVOa69W18ya8ur7Q/exec'; // 請替換成你的網址

    document.getElementById('recordForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const formData = new FormData(this);
      const data = {
        date: formData.get('date'),
        runningTime: Number(formData.get('runningTime')),
        walkTime: Number(formData.get('walkTime')),
        coachHomework: Number(formData.get('coachHomework'))
      };

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(data),
        headers: { 'Content-Type': 'application/json' }
      })
      .then(response => response.text())
      .then(msg => {
        alert("Record added!");
        this.reset();
        loadRecords(); // 更新紀錄
      })
      .catch(err => alert("Error: " + err.message));
    });

    function loadRecords() {
      fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
          const container = document.getElementById('records');
          container.innerHTML = '';

          data.forEach(row => {
            const formattedDate = new Date(row.date).toLocaleDateString();
            container.innerHTML += `<p>${formattedDate} - Running: ${row.runningTime} mins, Walk: ${row.walkTime} mins, Homework: ${row.coachHomework} times</p>`;
          });
        })
        .catch(err => {
          document.getElementById('records').innerText = "Failed to load records.";
          console.error(err);
        });
    }

    loadRecords(); // 頁面載入時取得資料
  </script>
</body>
</html>

