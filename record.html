<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>Workout Record</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 2rem auto; }
    label { display: block; margin: 0.5rem 0; }
    input, button { padding: 0.4rem; font-size: 1rem; }
    button { margin-top: 1rem; }
    #records p { background: #f0f0f0; padding: 0.6rem; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>Workout Record</h1>

  <form id="recordForm">
    <label>日期: <input type="date" name="date" required></label>
    <label>跑步時間 (分鐘): <input type="number" name="runningTime" required></label>
    <label>走路時間 (分鐘): <input type="number" name="walkTime" required></label>
    <label>教練作業次數: <input type="number" name="coachHomework" required></label>
    <button type="submit">新增紀錄</button>
  </form>

  <h2>歷史紀錄</h2>
  <div id="records">載入中...</div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbx9M6OuLyRjnf2E1yOxOeMdi2P3SBeyl9JRk6PzjYBR_17iakc6fkwVOa69W18ya8ur7Q/exec';

    // 格式化日期 yyyy/mm/dd
    function formatDate(dateStr) {
      const d = new Date(dateStr);
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth() + 1).padStart(2, '0');
      const dd = String(d.getDate()).padStart(2, '0');
      return `${yyyy}/${mm}/${dd}`;
    }

    // 讀取歷史紀錄
    function loadRecords() {
      const container = document.getElementById('records');
      container.textContent = '載入中...';

      fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
          container.innerHTML = '';
          if (!data || data.length === 0) {
            container.textContent = '目前沒有紀錄。';
            return;
          }
          data.forEach(row => {
            container.innerHTML += `<p>${formatDate(row.date)} - 跑步：${row.runningTime} 分鐘，走路：${row.walkTime} 分鐘，作業：${row.coachHomework} 次</p>`;
          });
        })
        .catch(err => {
          container.textContent = '載入失敗';
          console.error(err);
        });
    }

    // 新增紀錄
    document.getElementById('recordForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const formData = new FormData(this);
      const data = {
        date: formData.get('date'),
        runningTime: Number(formData.get('runningTime')),
        walkTime: Number(formData.get('walkTime')),
        coachHomework: Number(formData.get('coachHomework'))
      };

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(data)
      })
      .then(res => res.text())
      .then(msg => {
        alert(msg);
        this.reset();
        loadRecords(); // 新增後刷新列表
      })
      .catch(err => alert('發生錯誤: ' + err));
    });

    window.onload = loadRecords;
  </script>
</body>
</html>



